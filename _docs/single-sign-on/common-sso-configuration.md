---
title: "Common configuration for SSO providers"
description: Set up team sync, default SSO provider for accounts
group: single-sign-on
toc: true
---

Once you create an SSO provider account in Codefresh, you can:
* Automatically or manually sync the teams created in your Identity Provider (IdP) with Codefresh
* Set a default SSO provider for your account
* Override the account-level SSO provider for specific users


## Syncing teams in IdPs with Codefresh
Team sync synchronizes all users and teams provisioned in the IdP with Codefresh. 

If automatic team sync is enabled for the IdP in Codefresh, you can sync teams:
* Automatically, in the Codefresh UI when you set up the SSO account for the IdP, through the **Auto-sync team** option, if available. 
* Manually, through the Codefresh CLI's [synchronize teams command](https://codefresh-io.github.io/cli/teams/synchronize-teams/){:target="\_blank"}. 



### Manual team-sync via CLI 

Manually synchronize users and teams provisioned in your IdP through the Codefresh CLI with the `synchronize teams` command.

As an example, you can sync your Azure teams with the CLI: 

```shell
codefresh synchronize teams <my-client-name> -t azure
```
where:  
`<my-client-name>` is the Client Name/Assertion URL/Callback URL that is automatically generated by Codefresh when you save the SSO configuration for your provider.


{% include image.html
lightbox="true"
file="/images/administration/sso/azure/client-name.png"
url="/images/administration/sso/azure/client-name.png"
alt="SSO Client Name"
caption="SSO Client Name"
max-width="40%"
%}



### Team-sync with Codefresh pipelines

Both automated and manual team-syncs are possible only if the option is support for your IdP in Codefresh. 

To implement team-sync also for providers without this option, you can use Codefresh pipelines. 

A pipeline makes it possible to run team-sync periodically as a job. Use the CLI as a [freestyle step]({{site.baseurl}}/docs/pipelines/steps/freestyle/), as in the example below.

You can create a Git repository with a [codefresh.yml]({{site.baseurl}}/docs/pipelines/what-is-the-codefresh-yaml/) file with the following content:

```yaml
version: '1.0'
steps:
  syncMyTeams:
    title: syncTeams
    image: codefresh/cli
    commands:
      - 'codefresh synchronize teams my-client-name -t azure'
```

To fully automate this pipeline, you should set a [cron trigger]({{site.baseurl}}/docs/pipelines/triggers/cron-triggers/) for it. Depending on how you set up your Cron trigger, you can synchronize your teams every day/week/hour. 


### Team-sync and email domain restrictions
If the `Restrict inviting additional users by email address domain` is enabled for your account, manual sync via the CLI or sync via a pipeline, _does not invite new users_ to Codefresh.  
The output of the command will be similar to the following:

```json
[
  {
    "action": "update",
    "teams": [
      {
        "team": "developers",
        "members": [
          {
            "members": [],
            "action": "create"
          }
        ]
      },
      {
        "team": "DevOps",
        "members": [
          {
            "members": [],
            "action": "create"
          }
        ]
      }
    ]
  }
]
```

**Turn off the domain restriction**:

1. In the Codefresh UI, click **Settings**.
1. In the sidebar, from Access & Collaboration, select **User & Teams**, and then click the **Security** tab.
1. Turn off **Restrict inviting additional users by email address domain**.
1. Click **Save**.
1. Rerun the CLI sync command.

### Sync GitHub organization teams to Codefresh

As an admin, you may want to sync your GitHub Organization Teams with your Codefresh account. At the same time, you do not want to set up an SSO provider and have the users use any login provider they choose.

The Personal Access Token (PAT) from a user will sync ALL Organizations and ALL Teams to which the user has access. It is recommended to use a "machine" account to access the one organization you need.

1. Create a PAT that has access to read organizations and teams
1. Install and configure the Codefresh CLI

    `codefresh synchronize teams github -t github --tk $GHTOKEN`

1. The sync will invite all users except for those that have private email settings turned on.

Once the initial sync happens, you can set up a cron trigger pipeline to run the command on a schedule.